(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{134:function(t,e,n){var content=n(213);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("4e8b1e2f",content,!0,{sourceMap:!1})},135:function(t,e,n){var content=n(215);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("687f18a0",content,!0,{sourceMap:!1})},136:function(t,e,n){var content=n(217);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("dc654fba",content,!0,{sourceMap:!1})},137:function(t,e,n){var content=n(219);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("380577da",content,!0,{sourceMap:!1})},138:function(t,e,n){var content=n(221);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("370f8324",content,!0,{sourceMap:!1})},139:function(t,e,n){var content=n(223);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("536dbc0e",content,!0,{sourceMap:!1})},140:function(t,e,n){var content=n(225);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("78870bbc",content,!0,{sourceMap:!1})},141:function(t,e,n){var content=n(229);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("083078fa",content,!0,{sourceMap:!1})},142:function(t,e,n){var content=n(231);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("1aa857b4",content,!0,{sourceMap:!1})},143:function(t,e,n){var content=n(233);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("19b87796",content,!0,{sourceMap:!1})},144:function(t,e,n){var content=n(235);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("0881f118",content,!0,{sourceMap:!1})},145:function(t,e,n){var content=n(237);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("304b5b40",content,!0,{sourceMap:!1})},146:function(t,e,n){var content=n(239);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("29e00d55",content,!0,{sourceMap:!1})},147:function(t,e,n){var content=n(241);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("51dc17ae",content,!0,{sourceMap:!1})},212:function(t,e,n){"use strict";var o=n(134);n.n(o).a},213:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".dev-mode[data-v-80b09f02]{position:fixed;top:0;left:0}.dev-mode-button[data-v-80b09f02]{width:100%;opacity:0;transition:opacity .2s ease-in-out}.dev-mode-button[data-v-80b09f02]:hover,.dev-mode-enabled[data-v-80b09f02]{opacity:1}.dev-mode-display[data-v-80b09f02]{width:10em;background-color:#8bc34a}",""])},214:function(t,e,n){"use strict";var o=n(135);n.n(o).a},215:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,"span[data-v-52bf127a]:after{content:attr(last-letter);opacity:.4}",""])},216:function(t,e,n){"use strict";var o=n(136);n.n(o).a},217:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".chat-window[data-v-2749e516]{display:flex;flex-direction:column}.chat-messages[data-v-2749e516]{overflow-y:hidden;scroll-behavior:smooth;word-wrap:break-word}.chat-messages[data-v-2749e516]:hover{overflow-y:auto;scrollbar-width:thin}.left[data-v-2749e516]{color:var(--user);text-align:right}",""])},218:function(t,e,n){"use strict";var o=n(137);n.n(o).a},219:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".face-detection[data-v-4c0e0ff6]{width:100%;overflow:hidden}canvas[data-v-4c0e0ff6],video[data-v-4c0e0ff6]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}video[data-v-4c0e0ff6]{display:none}canvas[data-v-4c0e0ff6]{border-radius:15px 0 15px 0}",""])},220:function(t,e,n){"use strict";var o=n(138);n.n(o).a},221:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".word>span[data-v-5751fce6]{color:inherit;transition-property:color;transition-duration:.55s;transition-timing-function:ease-in-out}",""])},222:function(t,e,n){"use strict";var o=n(139);n.n(o).a},223:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".infotext[data-v-7cf1fe65]{color:var(--user);border:1px solid rgba(var(--bg-white-rgb),.5);border-radius:28px;padding:14px 18px}.infotext[data-v-7cf1fe65]:hover{border-width:3px;padding:12px 16px}",""])},224:function(t,e,n){"use strict";var o=n(140);n.n(o).a},225:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".bar[data-v-b6ae84b2]{background-color:var(--bg-white);height:1.5px;border-radius:8px;width:0;transition:width .3s ease-in-out}.bar.dark[data-v-b6ae84b2]{background-color:var(--bg-dark)}",""])},226:function(t,e,n){t.exports=n.p+"img/2c3a587.svg"},227:function(t,e,n){t.exports=n.p+"img/ebb62ae.svg"},228:function(t,e,n){"use strict";var o=n(141);n.n(o).a},229:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".container[data-v-90723a10]{width:100%}.splash-screen[data-v-90723a10]{width:100%;display:grid;grid-template-columns:100%;grid-template-rows:50% 50%;padding-left:10%;opacity:1;transition:opacity .5s ease;transition-delay:1s}.title[data-v-90723a10]{display:flex;flex-direction:column}.title>*[data-v-90723a10]{margin-top:auto}.subtitle[data-v-90723a10]{width:-webkit-max-content;width:-moz-max-content;width:max-content}div.fade-in[data-v-90723a10]{opacity:1}.gear-overlay[data-v-90723a10]{position:fixed;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .5s ease-in;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.large-gear[data-v-90723a10]{top:-200px;left:-100px}.large-gear[data-v-90723a10],.small-gear[data-v-90723a10]{transition:-webkit-transform 1s ease-in-out;transition:transform 1s ease-in-out;transition:transform 1s ease-in-out,-webkit-transform 1s ease-in-out;width:500px;position:absolute}.small-gear[data-v-90723a10]{top:120px;left:-300px}div.fade-out[data-v-90723a10]{opacity:0}",""])},230:function(t,e,n){"use strict";var o=n(142);n.n(o).a},231:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".splash-screen-effect{-webkit-filter:brightness(3.5);filter:brightness(3.5)}.splash-screen-effect-fade-out{transition:-webkit-filter 1s ease-out;transition:filter 1s ease-out;transition:filter 1s ease-out,-webkit-filter 1s ease-out;-webkit-filter:none;filter:none}",""])},232:function(t,e,n){"use strict";var o=n(143);n.n(o).a},233:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".content-display[data-v-002a1a0c]{margin:0 auto;display:flex;flex:1 1 0;width:100%;min-height:0;min-width:0;position:relative;flex-direction:column}.content-display>div[data-v-002a1a0c]{flex-grow:1}.content-title-text[data-v-002a1a0c]{position:absolute}.content-container[data-v-002a1a0c]{overflow:hidden}.full-size[data-v-002a1a0c]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}",""])},234:function(t,e,n){"use strict";var o=n(144);n.n(o).a},235:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".glitch-effect{-webkit-filter:url(#glitchFilter);filter:url(#glitchFilter);-webkit-animation:forceAnimation 1s infinite,glitch-effect-text-shadow .5s infinite;animation:forceAnimation 1s infinite,glitch-effect-text-shadow .5s infinite}@-webkit-keyframes glitch-effect-text-shadow{0%{text-shadow:1px 1px 1px red,-1px 0 0 #3ffeff,0 1px 0 #41ff41}to{text-shadow:-2px 0 1px red,0 1px 0 #3ffeff,0 0 1px #41ff41}}@keyframes glitch-effect-text-shadow{0%{text-shadow:1px 1px 1px red,-1px 0 0 #3ffeff,0 1px 0 #41ff41}to{text-shadow:-2px 0 1px red,0 1px 0 #3ffeff,0 0 1px #41ff41}}@-webkit-keyframes forceAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(.01deg);transform:rotate(.01deg)}}@keyframes forceAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(.01deg);transform:rotate(.01deg)}}",""])},236:function(t,e,n){"use strict";var o=n(145);n.n(o).a},237:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".log[data-v-01a33c98]{width:100%;overflow-y:hidden;scroll-behavior:smooth;white-space:nowrap}.log[data-v-01a33c98]:hover{overflow-y:auto;scrollbar-width:thin}.log-entry[data-v-01a33c98]{word-wrap:break-word;white-space:normal}.alert[data-v-01a33c98]{text-shadow:0 0 1px rgba(255,0,0,.8);color:rgba(var(--bg-white-rgb),.2)}.alert[data-v-01a33c98],.warn[data-v-01a33c98]{font-size:24px;line-height:16px}.warn[data-v-01a33c98]{text-shadow:0 0 1px rgba(233,233,91,.7);color:rgba(var(--bg-white-rgb),.3)}",""])},238:function(t,e,n){"use strict";var o=n(146);n.n(o).a},239:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".sound-wave{height:100%}.sound-canvas{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;height:100%;width:100%;opacity:.6}",""])},240:function(t,e,n){"use strict";var o=n(147);n.n(o).a},241:function(t,e,n){(t.exports=n(32)(!1)).push([t.i,".root[data-v-5a887e62]{height:100vh}.container[data-v-5a887e62]{margin:0 auto;display:flex;flex:1 1 0;width:100%;min-height:0;min-width:0}.flex-row[data-v-5a887e62]{flex-direction:row}.flex-column[data-v-5a887e62]{flex-direction:column}.bottom-thin-fixed[data-v-5a887e62]{position:fixed;bottom:0;left:0;right:0;height:128px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.top[data-v-5a887e62]{flex-grow:0}.bottom[data-v-5a887e62]{flex-grow:0.2}.left-column[data-v-5a887e62],.right-column[data-v-5a887e62]{flex-grow:0.3}.user-text[data-v-5a887e62]{color:var(--user);min-height:64px;margin-bottom:12px}.center-content[data-v-5a887e62]{justify-content:space-evenly;align-items:center}.content[data-v-5a887e62]{padding:12px}",""])},242:function(t,e,n){"use strict";n.r(e);var o=n(2),r=(n(49),n(18)),l=n.n(r),c={name:"dev-mode",data(){return{isExpanded:!0,isDebugMode:"debug"==this.$mode,previousMode:this.$mode}},methods:{toggleDebugMode(){this.isDebugMode=!this.isDebugMode,this.isDebugMode?(this.previousMode=this.$mode,this.$router.push({query:{mode:"debug"}})):this.$router.push({query:{mode:this.previousMode}})}}},h=(n(212),n(11)),d=Object(h.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dev-mode"},[n("button",{staticClass:"dev-mode-button",class:{"dev-mode-enabled":t.isDebugMode},on:{click:t.toggleDebugMode}},[t._v("Toggle Dev Mode")]),t._v(" "),t.isDebugMode?n("div",{staticClass:"dev-mode-display"},[t.isExpanded?n("div",[t._v("\n      test\n      "),n("nuxt-link",{attrs:{to:"/jsonDebug"}},[t._v("JSON Debug")]),t._v(" "),n("nuxt-link",{attrs:{to:"/intentOverview"}},[t._v("Dialogflow Intent Overview")])],1):t._e(),t._v(" "),n("button",{on:{click:function(e){t.isExpanded=!t.isExpanded}}},[t._v(t._s(t.isExpanded?"^":"v"))])]):t._e()])},[],!1,null,"80b09f02",null).exports;const f=[];requestAnimationFrame(function t(){let e=Date.now();f.forEach(t=>{let n=e-t.lastFrameTime;if(n>=t.timePerFrame){for(let i=0;i<t.timePerFrame;i+=n)t.callback();t.lastFrameTime=e}}),requestAnimationFrame(t)});var v={name:"type-writer",props:{text:{required:!0},speed:{default:40},removeSpeed:{default:-1}},data:()=>({previousAction:null,textActions:[],currentActionIndex:0,textActionsLength:0,typewriterText:"",maxCharactersBehind:200,speedMultiplier:1,typewriterInterval:void 0,frontLetterInterval:void 0,frontLetter:""}),watch:{text:{immediate:!0,handler:function(t,e){null==t&&(t=""),null==e&&(e="");let n=this.textEqualLength(t,e);for(let t=e.length-n-1;t>=0;t--)this.addAction({type:"remove",text:e[t]});for(let e=n;e<t.length;e++)this.addAction({type:"add",text:t[e]});this.animate()}}},methods:{textEqualLength(t,e){let n=Math.min(t.length,e.length);for(let o=0;o<n;o++)if(t[o]!==e[o])return o;return 0},animate(){this.stopAnimation(),this.typewriterInterval={callback:()=>{let t=this.popAction();if(this.previousAction=t,this.frontLetter="",null==t?(this.stopAnimation(),this.$emit("end-reached")):this.executeAction(t),-1!=this.removeSpeed){let t=this.getAction();t&&this.typewriterInterval&&(this.typewriterInterval.timePerFrame="add"==t.type?1e3/this.speed:1e3/this.removeSpeed)}},lastFrameTime:Date.now(),timePerFrame:1e3/this.speed},f.push(this.typewriterInterval),this.frontLetterInterval={callback:()=>{let t=this.getAction();if(null!=t){if("remove"==t.type){if(!(this.previousAction&&"remove"==this.previousAction.type))return}if(" "==t.text)this.frontLetter=" ";else{const t="abcdefghijklmnopqrstuvwxyz";this.frontLetter=t[Math.floor(Math.random()*t.length)]}}else this.frontLetter=""},lastFrameTime:Date.now(),timePerFrame:1e3/this.speed/10},f.push(this.frontLetterInterval)},stopAnimation(){if(void 0!==this.typewriterInterval){let t=f.indexOf(this.typewriterInterval);t>-1&&f.splice(t,1)}if(void 0!==this.frontLetterInterval){let t=f.indexOf(this.frontLetterInterval);t>-1&&f.splice(t,1),this.frontLetter=""}},getAction(){return this.textActionsLength<=0?null:this.textActions[this.currentActionIndex]},popAction(){if(this.textActionsLength<=0)return null;{let t=this.textActions[this.currentActionIndex];return this.currentActionIndex++,this.currentActionIndex%=this.maxCharactersBehind,this.textActionsLength--,t}},addAction(t){if(this.textActionsLength>=this.maxCharactersBehind){let t=this.popAction();null!=t&&this.executeAction(t)}let e=(this.currentActionIndex+this.textActionsLength)%this.maxCharactersBehind;this.textActions[e]=t,this.textActionsLength++},executeAction(t){"remove"==t.type?this.typewriterText=this.typewriterText.slice(0,-t.text.length):"add"==t.type&&(this.typewriterText+=t.text)}}},m=(n(214),Object(h.a)(v,function(){var t=this.$createElement;return(this._self._c||t)("span",{attrs:{"last-letter":this.frontLetter}},[this._v(this._s(this.typewriterText))])},[],!1,null,"52bf127a",null).exports),x={name:"chat",components:{TypeWriter:m},data:()=>({}),computed:{messages(){return this.$tstore.getters.messages}},watch:{messages:function(t){this.$nextTick(()=>{this.scrollToBottom()})}},methods:{scrollToBottom(){let t=this.$refs.chatMessages.lastElementChild;t&&t.scrollIntoView({behavior:"smooth",block:"end"})}},updated(){this.scrollToBottom()}},w=(n(216),Object(h.a)(x,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-window"},[this._m(0),this._v(" "),e("div",{ref:"chatMessages",staticClass:"chat-messages"},[this._l(this.messages,function(t,n){return e("div",{key:n,class:t.isUser?"left":"right"},[e("type-writer",{attrs:{text:t.isUser?t.text:"﹥⁠"+t.text}})],1)}),this._v(" "),e("br"),this._v(" "),e("br"),this._v(" "),e("br")],2)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-head"},[e("h6",[this._v("﹥Chat")])])}],!1,null,"2749e516",null).exports);n(68);const y={unpack_cascade:function(t){var e=new DataView(new ArrayBuffer(4)),p=8;e.setUint8(0,t[p+0]),e.setUint8(1,t[p+1]),e.setUint8(2,t[p+2]),e.setUint8(3,t[p+3]);var n=e.getInt32(0,!0);p+=4,e.setUint8(0,t[p+0]),e.setUint8(1,t[p+1]),e.setUint8(2,t[p+2]),e.setUint8(3,t[p+3]);var o=e.getInt32(0,!0);p+=4;for(var r=[],l=[],c=[],h=0;h<o;++h){var i;for(Array.prototype.push.apply(r,[0,0,0,0]),Array.prototype.push.apply(r,t.slice(p,p+4*Math.pow(2,n)-4)),p=p+4*Math.pow(2,n)-4,i=0;i<Math.pow(2,n);++i)e.setUint8(0,t[p+0]),e.setUint8(1,t[p+1]),e.setUint8(2,t[p+2]),e.setUint8(3,t[p+3]),l.push(e.getFloat32(0,!0)),p+=4;e.setUint8(0,t[p+0]),e.setUint8(1,t[p+1]),e.setUint8(2,t[p+2]),e.setUint8(3,t[p+3]),c.push(e.getFloat32(0,!0)),p+=4}return r=new Int8Array(r),l=new Float32Array(l),c=new Float32Array(c),function(t,e,s,h,d){t*=256,e*=256;for(var f=0,v=0,m=Math.pow(2,n)>>0,i=0;i<o;++i){for(var x=1,w=0;w<n;++w)x=2*x+(h[(t+r[f+4*x+0]*s>>8)*d+(e+r[f+4*x+1]*s>>8)]<=h[(t+r[f+4*x+2]*s>>8)*d+(e+r[f+4*x+3]*s>>8)]);if((v+=l[m*i+x-m])<=c[i])return-1;f+=4*m}return v-c[o-1]}},run_cascade:function(image,t,e){for(var n=image.pixels,o=image.nrows,r=image.ncols,l=image.ldim,c=e.shiftfactor,h=e.minsize,d=e.maxsize,f=e.scalefactor,v=h,m=[];v<=d;){for(var x=Math.max(c*v,1)>>0,w=v/2+1>>0,y=w;y<=o-w;y+=x)for(var T=w;T<=r-w;T+=x){var q=t(y,T,v,n,l);q>0&&m.push([y,T,v,q])}v*=f}return m},cluster_detections:function(t,e){t=t.sort(function(a,b){return b[3]-a[3]});for(var n,o,r,l,c,h,d,f,v,m,x=new Array(t.length).fill(0),w=[],i=0;i<t.length;++i)if(0==x[i]){for(var y=0,T=0,s=0,q=0,_=0,C=i;C<t.length;++C)n=t[i],o=t[C],r=void 0,l=void 0,c=void 0,h=void 0,d=void 0,f=void 0,v=void 0,m=void 0,r=n[0],l=n[1],c=n[2],h=o[0],d=o[1],f=o[2],v=Math.max(0,Math.min(r+c/2,h+f/2)-Math.max(r-c/2,h-f/2)),m=Math.max(0,Math.min(l+c/2,d+f/2)-Math.max(l-c/2,d-f/2)),v*m/(c*c+f*f-v*m)>e&&(x[C]=1,y+=t[C][0],T+=t[C][1],s+=t[C][2],q+=t[C][3],_+=1);w.push([y/_,T/_,s/_,q])}return w},instantiate_detection_memory:function(t){for(var e=0,n=[],i=0;i<t;++i)n.push([]);return function(t){for(n[e]=t,e=(e+1)%n.length,t=[],i=0;i<n.length;++i)t=t.concat(n[i]);return t}}};var T=y;const _="https://htl-leonding.github.io/2018-leonie/leonie-web-demo/2019-06-29-dist/face-detection/facefinder.cascade",C={shiftfactor:.1,minsize:100,maxsize:1e3,scalefactor:1.1};let k=!1,S=function(t,e,s,n,o){return-1};function L(t){let e=t.width,n=t.height,o=t.data,r=new Uint8Array(n*e);for(let t=0;t<n;++t)for(let n=0;n<e;++n)r[t*e+n]=(2*o[4*t*e+4*n+0]+7*o[4*t*e+4*n+1]+1*o[4*t*e+4*n+2])/10;return r}var M=class extends EventTarget{constructor(video,canvas,time){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this._stopped=!1,this.video=video,this.canvas=canvas,this.minDetectionTime=time,this.faceDetectionStartTime=1/0,this.onDetected=void 0,this.ctx=canvas.getContext("2d"),this.stream=null,this.ownsMediaStream=!1,t||(this.ownsMediaStream=!0,t=navigator.mediaDevices.getUserMedia({video:!0,audio:!1})),t.then(t=>{this.stream=t,this.video.srcObject=t;let e=t.getVideoTracks()[0].getSettings();this.canvas.width=e.width||640,this.canvas.height=e.height||480,this.start()}),this.picoUpdateMemory=T.instantiate_detection_memory(5),k||fetch(_).then(t=>{t.arrayBuffer().then(t=>{let e=new Int8Array(t);S=T.unpack_cascade(e),k=!0,l.a.log("Face detection...")})})}start(){let t=()=>{this.ctx.drawImage(this.video,0,0);let image={pixels:L(this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)),ncols:this.canvas.width,nrows:this.canvas.height,ldim:this.canvas.width},e=T.run_cascade(image,S,C);e=this.picoUpdateMemory(e),e=T.cluster_detections(e,.2),this.ctx.lineWidth=3,this.ctx.strokeStyle=" rgb(170, 81, 117, 0.7)",0==e.length&&(this.faceDetectionStartTime=Date.now());for(let i=0;i<e.length;i++)if(e[i][3]>50){this.ctx.beginPath();let t=e[i][2]/2,n=10;this.ctx.rect(e[i][1]-t,e[i][0]-t,2*t,2*t),this.ctx.moveTo(e[i][1]-t-n,e[i][0]),this.ctx.lineTo(e[i][1]-t+n,e[i][0]),this.ctx.moveTo(e[i][1]+t-n,e[i][0]),this.ctx.lineTo(e[i][1]+t+n,e[i][0]),this.ctx.moveTo(e[i][1],e[i][0]-t-n),this.ctx.lineTo(e[i][1],e[i][0]-t+n),this.ctx.moveTo(e[i][1],e[i][0]+t-n),this.ctx.lineTo(e[i][1],e[i][0]+t+n),this.ctx.stroke(),Date.now()-this.faceDetectionStartTime>=this.minDetectionTime&&(this.faceDetectionStartTime=Date.now(),this.dispatchEvent(new CustomEvent("detected",{x:e[i][1],y:e[i][0],radius:e[i][2]})),this.onDetected&&this.onDetected(e[i][1],e[i][0],e[i][2]))}this._stopped||requestAnimationFrame(t)};requestAnimationFrame(t)}stop(){if(this._stopped=!0,this.ownsMediaStream&&this.stream){let t=this.stream;t.getTracks().forEach(track=>{track.stop(),t.removeTrack(track)})}}},R={name:"face-detection",data:()=>({faceDetector:null,faceDetectionTime:500}),mounted(){let t=this.$refs.video,e=this.$refs.canvas;this.faceDetector=new M(t,e,this.faceDetectionTime,this.$tstore.actions.getOrCreateMediaStream()),this.faceDetector.addEventListener("detected",this.faceDetected)},methods:{faceDetected(t,e,n){this.$emit("face-detected",{type:"face-detected"})}},beforeDestroy(){this.faceDetector&&(this.faceDetector.removeEventListener("detected",this.faceDetected),this.faceDetector.stop())}},A=(n(218),Object(h.a)(R,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"face-detection"},[e("video",{ref:"video",attrs:{autoplay:"",playsinline:""}}),this._v(" "),e("canvas",{ref:"canvas"})])},[],!1,null,"4c0e0ff6",null).exports),I={props:["text"],data:()=>({}),watch:{text:{immediate:!0,handler:function(t,e){t?this.$tstore.actions.say(t).then(()=>{this.$emit("speech-end",!0)}):this.$emit("speech-end",!0)}}},methods:{}},D=Object(h.a)(I,function(){var t=this.$createElement;return(this._self._c||t)("div")},[],!1,null,null,null).exports,$=(n(69),{name:"letter-color-effect",props:{text:{required:!0},colorA:{required:!0,default:[0,0,0]},colorB:{required:!0,default:[0,0,0]},amount:{default:.3},speed:{default:550}},data:()=>({interval:void 0,words:[[{letter:"",color:""}]]}),watch:{text:{immediate:!0,handler(t){t||(t=""),this.words=t.split(" ").map(t=>t.split("").map(t=>({letter:t,color:"inherit"})))}}},methods:{randomValue:(t,e,n)=>Math.pow(Math.random()*(e-t)+t,n),lerpColors(t,e,n){return[this.lerp(t[0],e[0],n),this.lerp(t[1],e[1],n),this.lerp(t[2],e[2],n)]},lerp:(a,b,t)=>a+t*(b-a)},mounted(){this.interval=window.setInterval(()=>{this.words.forEach(t=>t.forEach(t=>{let e=this.randomValue(0,.7,3),n=this.lerpColors(this.colorA,this.colorB,e);t.color="red",t.color="rgb(".concat(n[0],",").concat(n[1],",").concat(n[2],")")}))},this.speed)},beforeDestroy(){clearInterval(this.interval)}}),E=(n(220),{props:["text"],components:{LetterColorEffect:Object(h.a)($,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",t._l(t.words,function(e,i){return n("span",{key:i,staticClass:"word"},[t._l(e,function(e,o){return n("span",{key:o,style:{color:e.color}},[t._v(t._s(e.letter))])}),t._v(" "),n("span")],2)}),0)},[],!1,null,"5751fce6",null).exports},methods:{clicked(){let t={type:"speech",text:this.text+""};this.$emit("user-input",t)}}}),O=(n(222),Object(h.a)(E,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infotext",on:{click:this.clicked}},[e("letter-color-effect",{attrs:{text:this.text,colorA:[237,236,237],colorB:[12,5,56]}})],1)},[],!1,null,"7cf1fe65",null).exports),U=(n(62),{data:()=>({}),props:["enabled"],watch:{enabled:{immediate:!0,handler:function(t){t?this.listen():this.stop()}}},methods:{listen(){this.$tstore.getters.speechIO.speechRecognitionOrDefault(null).then(text=>{if(text){l.a.info(text);let t={type:"speech",text:text};this.$emit("user-input",t)}else{l.a.info("Timeout");let t={type:"timeout"};this.$emit("user-input",t)}},t=>{l.a.error(t)})},stop(){this.$tstore.getters.speechIO.stopRecognition()}}}),B=Object(h.a)(U,function(){var t=this.$createElement;return(this._self._c||t)("div")},[],!1,null,null,null).exports,j={name:"progress-bar",props:["value","dark"],computed:{cssWidth:function(){return 100*this.value+"%"}}},F=(n(224),Object(h.a)(j,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"bar",class:{dark:this.dark},style:{width:this.cssWidth}})])},[],!1,null,"b6ae84b2",null).exports),main=n(66),P={name:"splash-screen",components:{TypeWriter:m,ProgressBar:F},data:()=>({titleTexts:["HTL-Leonding","HTL-Leonie"],titleTextIndex:0,creditsTexts:["","Made by: Stefan Brandmair, Fabian Ahammer, Fabian Prieschl, Christian Steyrer, Stephan Do"],creditsTextIndex:0,splashScreenVisible:!1,fadeIn:!1,largeGearRotation:0,largeGearTeeth:32,smallGearRotation:0,smallGearTeeth:24,gearRotationInterval:0,splashScreenFadeOut:!1}),mounted(){document.body.classList.add("splash-screen-effect"),Object(main.setTimeout)(()=>document.body.classList.add("splash-screen-effect-fade-out"),100),Object(main.setTimeout)(()=>{this.fadeIn=!0},1e3),Object(main.setTimeout)(()=>{document.body.classList.remove("splash-screen-effect"),document.body.classList.remove("splash-screen-effect-fade-out"),this.splashScreenVisible=!0},1300),this.gearRotationInterval=window.setInterval(()=>{this.largeGearRotation+=360/this.largeGearTeeth,this.smallGearRotation-=360/this.smallGearTeeth},2e3)},methods:{onTitleTextEnd(){this.titleTextIndex<this.titleTexts.length-1?window.setTimeout(()=>{this.titleTextIndex++},1e3):0==this.creditsTextIndex&&this.creditsTextIndex++},onCreditsTextEnd(){this.creditsTextIndex<=0||(Object(main.setTimeout)(()=>{this.splashScreenFadeOut=!0},1e3),Object(main.setTimeout)(()=>{this.fadeIn=!1},1600),Object(main.setTimeout)(()=>{this.$emit("user-input",{type:"timeout"})},2800))}},beforeDestroy(){window.clearInterval(this.gearRotationInterval)}},z=(n(228),n(230),Object(h.a)(P,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[t.splashScreenVisible?o("div",{staticClass:"splash-screen",class:{"glitch-effect":t.splashScreenFadeOut,"fade-out":t.splashScreenFadeOut}},[o("div",{staticClass:"title"},[o("h1",[o("type-writer",{attrs:{text:t.titleTexts[t.titleTextIndex],speed:10},on:{"end-reached":t.onTitleTextEnd}})],1)]),t._v(" "),o("div",{staticClass:"subtitle"},[o("progress-bar",{attrs:{value:1}}),t._v(" "),o("type-writer",{attrs:{text:t.creditsTexts[t.creditsTextIndex],speed:55},on:{"end-reached":t.onCreditsTextEnd}})],1)]):t._e(),t._v(" "),o("div",{staticClass:"gear-overlay",class:{"fade-in":t.fadeIn}},[o("img",{staticClass:"large-gear",style:{transform:"rotate("+t.largeGearRotation+"deg)"},attrs:{src:n(226)}}),t._v(" "),o("img",{staticClass:"small-gear",style:{transform:"rotate("+t.smallGearRotation+"deg)"},attrs:{src:n(227)}})])])},[],!1,null,"90723a10",null).exports),W={name:"content-display",components:{TypeWriter:m},props:{leonieResponse:{required:!0}},data:()=>({resetText:!1,overrideLeonieResponse:null}),computed:{contentTitleText(){if(!this.leonieResponse||!this.leonieResponse.content)return"";let text=this.leonieResponse.content.text||"",t=this.leonieResponse.type;return"image"==t||"website"==t?"":text},computedLeonieResponse(){return this.overrideLeonieResponse||this.leonieResponse}},watch:{leonieResponse:{immediate:!0,handler:function(t,e){this.resetText=!0,this.$nextTick(()=>{this.resetText=!1});let n=null;if("reload"==t.type)window.location.reload();else if("stop"==t.type){let t={type:"timeout"};this.$emit("user-input",t)}else"googleSearchResponse"==t.type&&e&&"googleSearch"==e.type?n={type:"website",content:{url:e.content.results[t.content.resultIndex||0].url,infotext:t.content.infotext,optionalInfotext:t.content.optionalInfotext}}:l.a.info("Leonie Response of type ".concat(t.type));this.overrideLeonieResponse=n}}}},G=(n(232),Object(h.a)(W,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.computedLeonieResponse?n("div",{staticClass:"content-display"},[t.contentTitleText?n("div",{staticClass:"content-title-text"},[n("br"),t._v(" "),n("h4",[t.resetText?t._e():n("type-writer",{attrs:{text:t.contentTitleText,speed:35}})],1)]):t._e(),t._v(" "),"website"==t.computedLeonieResponse.type?n("div",{staticClass:"content-container"},[n("iframe",{staticClass:"full-size",attrs:{src:t.computedLeonieResponse.content.url}})]):t._e(),t._v(" "),"image"==t.computedLeonieResponse.type?n("div",{staticClass:"content-container"},[n("img",{staticClass:"full-size",attrs:{src:t.computedLeonieResponse.content.url}})]):t._e(),t._v(" "),"googleSearch"==t.computedLeonieResponse.type?n("div",{staticClass:"content-container"},t._l(t.computedLeonieResponse.content.results,function(e,o){return n("div",{key:o},[n("h6",[t._v(t._s(e.title))]),t._v(" "),n("span",[t._v(t._s(e.displayUrl))]),t._v(" "),n("span",[t._v(t._s(e.snippet))])])}),0):t._e()]):t._e()},[],!1,null,"002a1a0c",null).exports),H={name:"glitch-effect"},V=(n(234),Object(h.a)(H,function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1",height:"0"}},[e("defs",[e("filter",{attrs:{id:"glitchFilter"}},[e("feTurbulence",{attrs:{type:"fractalNoise",baseFrequency:"0.000001 0.000001",numOctaves:"1",result:"warp",seed:"1"}},[e("animate",{attrs:{attributeName:"baseFrequency",attributeType:"XML",values:"0.02 0.5; 0.000001 0.000001; 0.002 0.4; 0.000001 0.000001;",dur:"0.9s",repeatCount:"indefinite"}})]),this._v(" "),e("feDisplacementMap",{attrs:{xChannelSelector:"R",yChannelSelector:"G",scale:"30",in:"SourceGraphic",in2:"warp"}})],1)])])},[],!1,null,null,null).exports);class Q{constructor(t){this.callback=t}log(t){let{async:e,stdout:n,stderr:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{async:void 0,stdout:void 0,stderr:void 0};t.level<=2&&this.callback(t)}}let N;var J={name:"show-log",components:{TypeWriter:m},data:()=>({log:[],visibleLogCount:1,maxHiddenLogs:5}),computed:{visibleLog(){return this.log.slice(0,this.visibleLogCount)}},watch:{visibleLogCount:function(t){this.$nextTick(()=>{this.scrollToBottom()})}},created(){null==N&&(N=new Q(this.logCallback)),l.a.addReporter(N)},beforeDestroy(){l.a.removeReporter(N)},methods:{logCallback(t){this.log.push(t),this.log.length>this.visibleLogCount+this.maxHiddenLogs&&(this.visibleLogCount=this.log.length-this.maxHiddenLogs)},doneTyping(t){this.visibleLogCount=Math.max(this.visibleLogCount,t+2)},scrollToBottom(){let t=this.$el.lastElementChild;t&&t.scrollIntoView({behavior:"smooth",block:"end"})}}},K=(n(236),Object(h.a)(J,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"log"},[t._l(t.visibleLog,function(e,o){return n("div",{key:o},[n("span",[0==e.level?n("span",{staticClass:"mdil mdil-alert-octagon alert"}):1==e.level?n("span",{staticClass:"mdil mdil-alert warn"}):t._e(),t._v(" "),n("type-writer",{staticClass:"log-entry",attrs:{text:(e.level>=2?"﹥⁠":"")+e.args},on:{"~end-reached":function(e){return t.doneTyping(o)}}})],1)])}),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("br")],2)},[],!1,null,"01a33c98",null).exports),X={name:"sound-wave",props:{scale:{default:1}},data:()=>({ctx:null,soundBuffer:[],soundSamplesCount:512,audio:{callback:null,scriptProcessor:null,stream:null}}),computed:{canvas:function(){return this.$refs.canvas}},mounted(){navigator.mediaDevices.getUserMedia?null!=this.canvas?(this.ctx=this.canvas.getContext("2d"),this.soundBuffer=new Array(Math.max(16,this.soundSamplesCount)).fill(0),this.audioProcess()):l.a.error("Could not initialize sound wave canvas"):l.a.error("Audio Access failed")},methods:{resizeCanvas(){let canvas=this.canvas;if(!canvas)return;let t=window.devicePixelRatio||1,e=Math.floor(canvas.clientWidth*t),n=Math.floor(canvas.clientHeight*t);canvas.width===e&&canvas.height===n||(canvas.width=e,canvas.height=n)},audioProcess(){var t=this;return Object(o.a)(function*(){try{t.audio.stream=yield t.$tstore.actions.getOrCreateMediaStream();let e=new AudioContext,n=e.createAnalyser(),o=e.createMediaStreamSource(t.audio.stream),r=e.createScriptProcessor(2048,1,1);n.smoothingTimeConstant=.85,n.fftSize=2*t.soundBuffer.length,o.connect(n),n.connect(r),r.connect(e.destination);let c=new Uint8Array(n.frequencyBinCount);t.audio.callback=()=>{c.length!=n.frequencyBinCount&&(c=new Uint8Array(n.frequencyBinCount)),n.getByteFrequencyData(c);for(let i=0;i<t.soundBuffer.length;i++){let e=c[i];t.soundBuffer[i]=e}t.redraw()},t.audio.scriptProcessor=r,r.addEventListener("audioprocess",t.audio.callback)}catch(t){l.a.error(t)}})()},redraw(){if(this.resizeCanvas(),null==this.ctx||null==this.canvas)return;let t=this.ctx;if(t.clearRect(0,0,this.canvas.width,this.canvas.height),0==this.scale)return;t.globalCompositeOperation="lighter",t.lineWidth=2.5,t.strokeStyle="rgba(255,255,255, 0.7)";let e=this.canvas.height-30;t.beginPath(),t.moveTo(0,e),t.lineTo(this.canvas.width,e),t.stroke();for(let i=0;i<this.soundBuffer.length;i++){let n=this.soundBuffer[i];n*=.2,n*=this.scale;let o=10*(Math.cos(i/this.soundBuffer.length*30/Math.PI)+1);i/this.soundBuffer.length>.3&&(o*=0);let r=i/this.soundBuffer.length*(this.canvas.width/2),l=this.canvas.width/2;l+=i%2==0?r:-r,t.beginPath(),t.moveTo(l,e),t.lineTo(l,e-n-o),t.stroke()}}},beforeDestroy(){if(this.audio.scriptProcessor&&this.audio.scriptProcessor.removeEventListener("audioprocess",this.audio.callback),this.audio.stream){let t=this.audio.stream;this.audio.stream.getTracks().forEach(track=>{track.stop(),t.removeTrack(track)})}}},Y=(n(238),Object(h.a)(X,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sound-wave"},[e("canvas",{ref:"canvas",staticClass:"sound-canvas"})])},[],!1,null,null,null).exports);window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition,window.SpeechRecognition||(window.SpeechRecognition=function(){this.onstart=null,this.onend=null,this.onresult=null,this.isStopped=!1;let t=this;this.start=function(){t.onstart&&t.onstart(),setTimeout(t.stop,500)},this.stop=function(){t.isStopped||(t.isStopped=!0,t.onend())}},window.SpeechRecognition.isPolyfilled=!0);var Z={components:{DevMode:d,Chat:w,FaceDetection:A,TextToSpeech:D,SpeechToText:B,InfoText:O,TypeWriter:m,ProgressBar:F,SplashScreen:z,ContentDisplay:G,GlitchEffect:V,ShowLog:K,SoundWave:Y},data(){return{showSplashScreen:"release"==this.$mode,userText:"",leonieResponse:null,isSpeaking:!1,dialogflowQuery:!1}},computed:{speechRecognitionRunning(){return null!=this.$tstore.getters.speechIO.recognition},infotext(){if(null==this.leonieResponse||null==this.leonieResponse.content)return[];let t=this.leonieResponse.content.infotext||[],e=this.leonieResponse.content.optionalInfotext||[];if(t.length>4)return t.slice(0,4);if(t.length<4){let n=4-t.length;if(e.length<=n)return t.concat(e);{let o=[],r=new Set;for(let i=0;i<n;i++){let t=Math.floor(Math.random()*e.length);for(;r.has(t);)t=(t+1)%n;r.add(t),o.push(e[t])}return t.concat(o)}}return t},textToSay(){return null==this.leonieResponse||null==this.leonieResponse.content?"":this.leonieResponse.content.text||""},recognitionEnabled(){return this.leonieResponse&&!this.isSpeaking&&!this.dialogflowQuery}},watch:{leonieResponse:function(t){t&&(this.isSpeaking=!0)}},mounted(){window.SpeechRecognition.isPolyfilled&&l.a.warn("\tPlease use Chrome!\n(your browser doesn't have a working speech recognition)"),l.a.log(this.$route.fullPath)},methods:{getLeonieResponse(text){return this.$tstore.actions.queryBackend(text)},handleLeonieResponse(t){if(this.setLeonieResponse(t),!t)return l.a.warn("Leonie didn't respond"),void this.goToTimeoutState()},handleSpeech(text){var t=this;return Object(o.a)(function*(){if(t.userText=text,text){t.dialogflowQuery=!0;try{let e=yield t.getLeonieResponse(text);l.a.info(e),t.handleLeonieResponse(e)}catch(t){l.a.error(t)}finally{t.dialogflowQuery=!1}}else t.goToTimeoutState()})()},sendChatMessage(t){this.$tstore.mutations.chatMessage(t)},onUserInput(t){l.a.info("User Input of type ".concat(t.type)),this.showSplashScreen=!1,this.userText&&(this.sendChatMessage({sender:"User",text:this.userText,isUser:!0}),this.sendChatMessage({sender:"Leonie",text:this.textToSay,isUser:!1}),this.userText=""),"face-detected"==t.type?this.setLeonieResponse({type:"say",content:{text:"Hallo, ich bin Leonie! Wie kann ich dir helfen?",infotext:[],optionalInfotext:["Stopp","Leonie","Kannst du tanzen?","Öffne das Quiz","Wie alt bist du?","Wer hat dich gemacht?","Wie gehts?","Hallo Leonie","Was kann Leonie","HTL Webseite"]}}):"timeout"==t.type?this.goToTimeoutState():"speech"==t.type&&this.handleSpeech(t.text)},goToTimeoutState(){this.setLeonieResponse(null)},setLeonieResponse(t){this.leonieResponse=null,null!=t&&(this.leonieResponse=t)}}},tt=(n(240),Object(h.a)(Z,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"root container flex-column"},[n("dev-mode"),t._v(" "),n("glitch-effect"),t._v(" "),n("div",{staticClass:"container flex-row"},[n("div",{staticClass:"container left-column"},[n("show-log")],1),t._v(" "),n("div",{staticClass:"container center-column flex-column"},[n("div",{staticClass:"top"},[n("h3",{staticClass:"user-text"},[n("type-writer",{attrs:{text:t.userText}})],1)]),t._v(" "),n("div",{staticClass:"content container"},[t.leonieResponse?n("div",{staticClass:"container"},[n("content-display",{attrs:{leonieResponse:t.leonieResponse},on:{"user-input":t.onUserInput}}),t._v(" "),t.isSpeaking?n("text-to-speech",{attrs:{text:t.textToSay},on:{"speech-end":function(e){t.isSpeaking=!1}}}):t._e()],1):n("div",{staticClass:"container"},[t.showSplashScreen?n("splash-screen",{attrs:{removeSpeed:200},on:{"user-input":t.onUserInput}}):n("face-detection",{on:{"face-detected":t.onUserInput}})],1)])]),t._v(" "),n("div",{staticClass:"container right-column"},[n("chat",{staticStyle:{width:"100%"}})],1)]),t._v(" "),n("div",{staticClass:"container bottom center-content"},t._l(t.infotext,function(e,o){return n("info-text",{key:o,attrs:{text:e},on:{"user-input":t.onUserInput}})}),1),t._v(" "),n("div",{staticClass:"bottom-thin-fixed"},[n("speech-to-text",{attrs:{enabled:t.recognitionEnabled},on:{"user-input":t.onUserInput}}),t._v(" "),n("sound-wave",{directives:[{name:"show",rawName:"v-show",value:t.recognitionEnabled,expression:"recognitionEnabled"}]})],1)],1)},[],!1,null,"5a887e62",null));e.default=tt.exports}}]);
